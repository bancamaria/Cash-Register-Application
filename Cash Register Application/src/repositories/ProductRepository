package repositories;
import model.Product;
import java.util.Set;
import java.util.TreeSet;

public class ProductRepository {
    private Set<Product> products;

    public ProductRepository() {
        products = new TreeSet<>();
    }

    public Set<Product> getProducts() {
        return products;
    }

    public boolean add(Product p) {
        if (getProductById(p.getId()) != null) {
            return false;
        }
        return products.add(p);
    }

    public Product getProductById(int id) {
        for (Product p : products) {
            if (id == p.getId())
                return p;
        }
        return null;
    }

    public boolean remove(int id) {
        Product p = getProductById(id);
        if (p == null)
            return false;
        return products.remove(p);
    }

    public Set<Product> getProductsBycCategoryNo(int categoryNo) {
        Set<Product> result = null;
        for (Product p : products) {
            if (categoryNo == p.getCategoryNo()) {
                if (result == null)
                    result = new TreeSet<>();
                result.add(p);
            }
        }
        return result;
    }

    public boolean setProductCategoryNo(int id, int categoryNo) {
        Product p = getProductById(id);
        if (p == null)
            return false;
        p.setCategoryNo(categoryNo);
        return true;
    }

    public Set<Product> getProductsByProductName(String productName) {
        Set<Product> result = null;
        for (Product p : products) {
            if (productName.equals(p.getProductName())) {
                if (result == null)
                    result = new TreeSet<>();
                result.add(p);
            }
        }
        return result;
    }

    public boolean setProductName(int id, String productName) {
        Product p = getProductById(id);
        if (p == null)
            return false;
        p.setProductName(productName);
        return true;
    }

    public Set<Product> getProductsByPrice(float price) {
        Set<Product> result = null;
        for (Product p : products) {
            if (Float.compare(price, p.getPrice()) == 0) {
                if (result == null)
                    result = new TreeSet<>();
                result.add(p);
            }
        }
        return result;
    }

    public boolean setProductPrice(int id, float price) {
        Product pc = getProductById(id);
        if (pc == null)
            return false;
        pc.setPrice(price);
        return true;
    }

    public Set<Product> getProductsByDiscount(float discount) {
        Set<Product> result = null;
        for (Product p : products) {
            if (Float.compare(discount, p.getDiscount()) == 0) {
                if (result == null)
                    result = new TreeSet<>();
                result.add(p);
            }
        }
        return result;
    }

    public boolean setProductDiscount(int id, float discount) {
        Product p = getProductById(id);
        if (p == null)
            return false;
        p.setDiscount(discount);
        return true;
    }

    public Set<Product> getProductsByQuantity(int quantity) {
        Set<Product> result = null;
        for (Product p : products) {
            if (quantity == p.getQuantity()) {
                if (result == null)
                    result = new TreeSet<>();
                result.add(p);
            }
        }
        return result;
    }

    public boolean setProductQuantity(int id, int quantity) {
        Product p = getProductById(id);
        if (p == null)
            return false;
        p.setQuantity(quantity);
        return true;
    }
}